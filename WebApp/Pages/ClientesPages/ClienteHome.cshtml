@page
@using Microsoft.AspNetCore.Authorization
@model WebApp.Pages.Clientes.ClienteHomeModel
@attribute [Authorize(Roles = "Cliente")]

@section Scripts {
    <script>
        // Captura el JWT desde la cookie
        var userToken = '@HttpContext.Request.Cookies["jwt_token"]';
    </script>
    <script src="~/js/ControlActions.js"></script>
    <script src="~/js/Pages/ClientesPages/ClienteHome.js" asp-append-version="true"></script>
}

<h2 class="mb-4">Bienvenido, Cliente</h2>

<input type="hidden" id="hdnClienteId" value="@Model.ClienteId" />
<input type="hidden" id="hdnClienteEmail" value="@Model.ClienteEmail" />

<div class="text-end mb-3">
    <a asp-page="/ClientesPages/ClienteHome" class="btn btn-outline-dark">⬅️ Volver</a>
</div>

<div class="row mb-4">
    <!-- Sección: Cuentas Asociadas -->
    <div class="col-sm-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                💳 Cuentas Asociadas
            </div>
            <div class="card-body">
                <table id="tblCuentasHome"
                       class="table table-bordered table-sm"
                       style="width:100%">
                    <thead class="table-light">
                        <tr>
                            <th>Banco</th>
                            <th>Tipo de Cuenta</th>
                            <th>Número IBAN</th>
                            <th>Saldo</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Sección: Últimas Transacciones -->
    <div class="col-sm-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                🔔 Últimas Transacciones
            </div>
            <div class="card-body">
                <table id="tblUltimasTransacciones"
                       class="table table-bordered table-sm-6"
                       style="width:100%">
                    <thead class="table-light">
                        <tr>
                            <th>Fecha</th>
                            <th>Descripción</th>
                            <th>Monto</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Enlaces y acciones adicionales -->
<div class="footer-links">
    <a asp-page="/ClientesPages/AgregarCuenta" class="btn btn-outline-primary me-2">➕ Agregar Cuenta</a>
    <button id="btnNuevaTransaccion" class="btn btn-outline-success me-2">💸 Nueva Transacción</button>
    <a asp-page="/ClientesPages/TransaccionesCliente" class="btn btn-outline-secondary me-2">📄 Todas las Transacciones</a>
    <a asp-page="/ClientesPages/Bancos" class="btn btn-outline-secondary me-2">🏦 Bancos Registrados</a>
    <a asp-page="/ClientesPages/PromocionesActivas" class="btn btn-outline-secondary me-2">🔖 Promociones Activas</a>
    <a asp-page="/ClientesPages/Comercios" class="btn btn-outline-secondary me-2">🛍️ Comercios Registrados</a>
</div>
